<app-dashboard-layout [userProfile]="userProfile" [pageTitle]="pageTitle">
  <div class="form-container">
    <div class="page-header">
      <button class="btn-back" (click)="goBack()">
        &larr; Voltar para Op√ß√µes de Refei√ß√µes
      </button>
    </div>

    <div class="form-card">
      <form [formGroup]="mealForm" (ngSubmit)="onSubmit()">
        <!-- Linha 1: Nome e Tipo -->
        <div class="form-row">
          <div class="form-group">
            <label for="name">Nome da Op√ß√£o</label>
            <input id="name" type="text" formControlName="name" placeholder="Ex: Ovos com Fruta">
          </div>
          <div class="form-group">
            <label for="type">Tipo de Refei√ß√£o</label>
            <select id="type" formControlName="type">
              <option value="" disabled>Selecione o tipo</option>
              <option *ngFor="let type of mealTypes" [value]="type">{{ type }}</option>
            </select>
          </div>
        </div>

        <!-- Se√ß√£o de Itens Din√¢micos -->
        <div class="items-section">
          <h3 class="items-title">Itens da Refei√ß√£o</h3>
          <div formArrayName="items">
            <div *ngFor="let item of items.controls; let i=index" [formGroupName]="i" class="item-row">
              <div class="form-group item-quantity">
                <label for="quantity-{{i}}">Quantidade</label>
                <input id="quantity-{{i}}" type="text" formControlName="quantity" placeholder="Ex: 2 fatias">
              </div>
              <div class="form-group item-description">
                <label for="description-{{i}}">Descri√ß√£o</label>
                <input id="description-{{i}}" type="text" formControlName="description" placeholder="Ex: P√£o integral">
              </div>
              <div class="item-actions">
                <button type="button" class="btn-icon btn-delete" title="Remover Item" (click)="removeItem(i)" [disabled]="items.length <= 1">
                  üóëÔ∏è
                </button>
              </div>
            </div>
          </div>
          <button type="button" class="btn-secondary btn-add-item" (click)="addItem()">
            <span class="btn-icon">‚ûï</span>
            Adicionar outro item
          </button>
        </div>

        <!-- A√ß√µes do Formul√°rio -->
        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="goBack()">Cancelar</button>
          <button type="submit" class="btn-primary" [disabled]="mealForm.invalid">
            {{ isEditMode ? 'Salvar Altera√ß√µes' : 'Salvar Op√ß√£o' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</app-dashboard-layout>
